ANA EVELIN HERNANDEZ MARTINEZ 20171001620

-- CONSULTAS PARA ETL TAREA 2 BDD2

-- Llenar tabla Tienda
SELECT TIENDA.ID_TIENDA, DIRECCION.COLONIA
  FROM TIENDA JOIN DIRECCION ON 
  TIENDA.ID_DIRECCION=DIRECCION.ID_DIRECCION;

-- Llenar tabla Empleado
SELECT ID_EMPLEADO, CONCAT(NOMBRE, ' ', APELLIDO) Nombre, ID_TIENDA
  FROM EMPLEADO;

-- Llenar tabla cliente
SELECT ID_CLIENTE, CONCAT(NOMBRE, ' ', APELLIDO) Nombre
  FROM CLIENTE;

-- Llenar tabla Departamento
SELECT * FROM DEPARTAMENTO;

-- Llenar tabla Tiempo
SELECT CONVERT(DATE, FECHA_PAGO) ID_Tiempo, DATEPART(YEAR, FECHA_PAGO) a√±o, DATEPART(MONTH, FECHA_PAGO) mes, DATEPART(WEEK, FECHA_PAGO semana, 
(DATEPART(QUARTER, FECHA_PAGO)/3)+1 semestre, DATEPART(QUARTER, FECHA_PAGO) trimestre, DATENAME(WEEKDAY, FECHA_PAGO) DiaDeSemana
  FROM PAGO
  GROUP BY PAGO.FECHA_PAGO;

-- Llenar tabla HechosPago
SELECT DEPARTAMENTO.ID_DEPARTAMENTO, CLIENTE.ID_CLIENTE, EMPLEADO.ID_EMPLEADO, CONVERT(DATE, FECHA_PAGO) ID_Tiempo, COUNT(*) PagosTotal, 
SUM(MONTO) MontoTotal
  FROM PAGO 
    INNER JOIN EMPLEADO ON PAGO.ID_EMPLEADO=EMPLEADO.ID_EMPLEADO 
    INNER JOIN DIRECCION ON EMPLEADO.ID_DIRECCION=DIRECCION.ID_DIRECCION 
    INNER JOIN CIUDAD ON DIRECCION.ID_CIUDAD=CIUDAD.ID_CIUDAD 
    INNER JOIN DEPARTAMENTO ON CIUDAD.ID_DEPARTAMENTO=DEPARTAMENTO.ID_DEPARTAMENTO
    INNER JOIN CLIENTE ON PAGO.ID_CLIENTE=CLIENTE.ID_CLIENTE 
  GROUP BY DEPARTAMENTO.ID_DEPARTAMENTO, CLIENTE.ID_CLIENTE, EMPLEADO.ID_EMPLEADO, PAGO.FECHA_PAGO